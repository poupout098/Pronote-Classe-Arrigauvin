<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Mini Pronote++</title>

<style>
body{
  font-family: "Segoe UI", Arial, sans-serif;
  background:#f4f6f9;
  margin:0;
}
.nav{
  display:flex;
  justify-content:center;
  gap:20px;
  background:#003366;
  padding:15px;
}
.nav button{
  background:white;
  color:#003366;
  border:none;
  padding:12px 20px;
  border-radius:8px;
  font-weight:600;
  cursor:pointer;
}
button{
  background:#0066cc;
  color:white;
  border:none;
  padding:10px 16px;
  border-radius:8px;
  cursor:pointer;
}
button.delete{
  background:#cc0000;
  margin-left:10px;
}
.login,.main,.admin-panel,.appel-panel{
  background:white;
  padding:30px;
  border-radius:12px;
  max-width:1000px;
  margin:40px auto;
  box-shadow:0 10px 25px rgba(0,0,0,0.1);
}
.section{
  background:#f9fafb;
  padding:20px;
  margin:20px 0;
  border-left:6px solid #0066cc;
  border-radius:10px;
}
h2,h3{ text-align:center; color:#003366; }
input,textarea,select{
  width:100%;
  padding:10px;
  margin:8px 0;
  border-radius:6px;
  border:1px solid #ccc;
}
.presence{ width:80px; }
.readonly{ background:#e9ecef; }
.info{
  background:#eef3ff;
  padding:10px;
  border-radius:8px;
  text-align:center;
  font-weight:600;
  margin-bottom:15px;
}
</style>
</head>

<body>

<!-- NAV -->
<div class="nav" id="navbar" style="display:none">
  <button onclick="ouvrir('pronote')">ğŸ“˜ Accueil</button>
  <button onclick="ouvrir('appel')">ğŸ“‹ Vie scolaire</button>
  <button onclick="logout()">ğŸšª DÃ©connexion</button>
</div>

<!-- LOGIN -->
<div class="login" id="loginBox">
  <h2>Connexion Pronote ++</h2>
  <input id="username" placeholder="Utilisateur">
  <input id="password" type="password" placeholder="Mot de passe">
  <button onclick="login()">Se connecter</button>
  <p id="error" style="color:red"></p>
</div>

<!-- ELEVE -->
<div class="main" id="pronotePanel" style="display:none">
  <h2 id="studentName"></h2>

  <div class="section">
    <h3>ğŸ“Š Notes</h3>
    <ul id="studentGrades"></ul>
  </div>

  <div class="section">
    <h3>ğŸ« Vie scolaire</h3>
    <p id="studentVie"></p>
  </div>

  <div class="section">
    <h3>ğŸ“‹ Historique des appels</h3>
    <ul id="studentAppel"></ul>
  </div>

  <div class="section">
    <h3>ğŸ“„ Documents</h3>
    <ul id="studentPDFs"></ul>
  </div>

  <div class="section">
    <h3>ğŸ“š Devoirs</h3>
    <ul id="studentDevoirs"></ul>
  </div>

  <div class="section">
    <h3>ğŸ•’ Emploi du temps</h3>
    <pre id="studentEDT"></pre>
  </div>
</div>

<!-- CARNET -->
<div class="appel-panel" id="appelPanel" style="display:none">
  <div class="info">ğŸ”’ Carnet lecture seule pour les Ã©lÃ¨ves</div>
  <div>Travail non fait <input class="presence" readonly></div>
  <div>Retard <input class="presence" readonly></div>
  <div>Absences <input class="presence" readonly></div>
  <div>Fournitures <input class="presence" readonly></div>
</div>

<!-- ADMIN -->
<div class="admin-panel" id="adminPanel" style="display:none">
  <h2>âš™ï¸ Panneau Admin</h2>

  <select id="adminSelect" onchange="loadAdminData()"></select>

  <div class="section">
    <h3>ğŸ“Š Notes</h3>
    <input id="newNote" placeholder="Ex : Maths 15/20">
    <button onclick="addNote()">Ajouter</button>
    <ul id="adminNotes"></ul>
  </div>

  <div class="section">
    <h3>ğŸ“‹ Appel</h3>
    <input type="date" id="appelDate">
    <select id="appelStatut">
      <option>PrÃ©sent</option>
      <option>Absent</option>
      <option>Retard</option>
    </select>
    <button onclick="validerAppel()">Valider lâ€™appel</button>
    <ul id="adminAppel"></ul>
  </div>

  <div class="section">
    <h3>ğŸ•’ Emploi du temps</h3>
    <textarea id="adminEDT"></textarea>
  </div>
</div>

<script>
const eleves=[
  {u:"gustav",p:"2019",n:"Gustav"},
  {u:"julia",p:"2016",n:"Julia"}
];

let logged=null;

function def(){
  return{notes:[],vie:"",pdfs:[],devoirs:[],edt:"",appel:[]};
}
function get(u){ return JSON.parse(localStorage.getItem(u))||def(); }
function set(u,d){ localStorage.setItem(u,JSON.stringify(d)); }

function login(){
  const u=username.value,p=password.value;
  if(u==="admin"&&p==="admin123"){
    logged="admin";
    navbar.style.display="flex";
    loginBox.style.display="none";
    adminPanel.style.display="block";
    ouvrir('pronote');
    adminSelect.innerHTML="";
    eleves.forEach(e=>{
      let o=document.createElement("option");
      o.value=e.u;o.text=e.n;adminSelect.appendChild(o);
    });
    loadAdminData();
    return;
  }
  const e=eleves.find(x=>x.u===u&&x.p===p);
  if(!e){ error.innerText="Erreur";return; }
  logged=e.u;
  navbar.style.display="flex";
  loginBox.style.display="none";
  pronotePanel.style.display="block";
  studentName.innerText="Bienvenue "+e.n;
  loadEleve();
}

function logout(){ location.reload(); }

function ouvrir(o){
  pronotePanel.style.display=o==="pronote"?"block":"none";
  appelPanel.style.display=o==="appel"?"block":"none";
}

function loadEleve(){
  const d=get(logged);
  studentGrades.innerHTML=d.notes.map(n=>`<li>${n}</li>`).join("");
  studentVie.innerText=d.vie;
  studentEDT.innerText=d.edt;
  studentAppel.innerHTML=d.appel.map(a=>`<li>${a.date} : ${a.statut}</li>`).join("");
}

function loadAdminData(){
  const u=adminSelect.value;
  const d=get(u);
  adminNotes.innerHTML=d.notes.map((n,i)=>`<li>${n}<button class="delete" onclick="delNote(${i})">X</button></li>`).join("");
  adminAppel.innerHTML=d.appel.map(a=>`<li>${a.date} : ${a.statut}</li>`).join("");
  adminEDT.value=d.edt;
}

function addNote(){
  const u=adminSelect.value,d=get(u);
  d.notes.push(newNote.value);
  set(u,d); newNote.value=""; loadAdminData();
}

function delNote(i){
  const u=adminSelect.value,d=get(u);
  d.notes.splice(i,1); set(u,d); loadAdminData();
}

function validerAppel(){
  const u=adminSelect.value,d=get(u);
  d.appel.push({date:appelDate.value,statut:appelStatut.value});
  set(u,d); loadAdminData();
}

adminEDT?.addEventListener("input",()=>{
  const u=adminSelect.value,d=get(u);
  d.edt=adminEDT.value; set(u,d);
});
</script>

</body>
</html>
